groups:

- name: SmartHomeExporter

  rules:

    - alert: SmartHomeCommandNotProcessed
      expr: 'rate(openhab_monitoring_command_sent[2m]) == 0 and rate(openhab_monitoring_command_received[2m]) == 0'
      for: 5m
      labels:
        severity: critical
      annotations:
        summary:  Openhab does not accept nor does it signal the monitoring command.
        description: "Openhab should accept and signal the command.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

    - alert: SmartHomeValueNotProcessed
      expr: 'rate(openhab_monitoring_value_sent[2m]) == 0 and rate(openhab_monitoring_value_received[2m]) == 0'
      for: 5m
      labels:
        severity: critical
      annotations:
        summary:  Openhab does not accept nor does it signal the monitoring value.
        description: "Openhab should accept and signal the value.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

    - alert: SmartHomeValueNotWrittenToInflux
      expr: 'rate(influxdb_openhab_monitoring_value_change[2m]) == 0'
      for: 5m
      labels:
        severity: critical
      annotations:
        summary:  Influx did not receive any monitoring value - but it should have from openhab.
        description: "Influx should receive regular updates of the monitoring value. \n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

    - alert: SmartHomeCommandNotWrittenToInflux
      expr: 'rate(influxdb_openhab_monitoring_command_change[2m]) == 0'
      for: 5m
      labels:
        severity: critical
      annotations:
        summary:  Influx did not receive any monitoring command - but it should have from openhab.
        description: "Influx should receive regular updates of the monitoring command. \n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

    - alert: SmartHomeNoValueWrittenToInflux
      expr: 'rate(influxdb_openhab_monitoring_any_value_change[2m]) == 0'
      for: 5m
      labels:
        severity: critical
      annotations:
        summary:  Influx did not receive any value - but it should have from openhab.
        description: "Influx should receive regular updates of values. \n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"

    - alert: SmartHomeNoValueWrittenToInfluxLongterm
      expr: 'rate(influxdb_openhab__longterm_monitoring_any_value_change[2m]) == 0'
      for: 5m
      labels:
        severity: critical
      annotations:
        summary:  Influx did not update it's longterm db.
        description: "Influx should update values in the longterm db at least on a daily basis. \n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}"
